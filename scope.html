<!doctype html>
<html lang="en">
 <head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=devich-width, initial-scale=1">
  <meta name="Generator" content="EditPlus®">
  <meta name="Author" content="">
  <meta name="Keywords" content="shinhwa的博客">
  <meta name="Description" content="">
  <title>Shinhwa</title>
  <link href="css/bootstrap.css" rel="stylesheet">
  <link rel="shortcut icon" href="favicon.ico" />
  <script src="js/jquery.js"></script>
  <script src="js/bootstrap.min.js"></script>
  
  <style>
  .textIndent{text-indent:2em}
  .line{height:1px;border-top:1px solid red;margin-bottom:10px}
  .title{background-color:#7777A4;padding:10px;color:white}
  .clearMB{margin-bottom:0!important}
  .mt{margin-top:50px}
  .bi{height:200px;background:url(images/banner.jpg) no-repeat;background-size:100% 200px;
  background-attachment:fixed;background-origin:content-box;}
  </style>
  <script>
  
  
  </script>
 </head>
 <body>
 <div class="navbar navbar-default navbar-fixed-top">
	<div class="navbar-header">
		<button data-toggle="collapse" class="navbar-toggle" data-target=".navbar-responsive-collapse">
			<span class="icon-bar"></span>
			<span class="icon-bar"></span>
			<span class="icon-bar"></span>
		</button>
		<a class="navbar-brand" href="scope.html">闭包</a>
	</div>
	<div class="collapse navbar-collapse navbar-responsive-collapse">
		<ul class="nav navbar-nav">
			<li><a href="#">aa</a></li>
			<li><a href="#">aa</a></li>
			<li><a href="#">aa</a></li>
		</ul>
	</div>
 </div>
	 <div class="container">
		
		 <div class="col-lg-12 bi mt">
		 </div>
	 </div>
	<div class="container" >
	<div class="row">
		<div class="col-lg-12">
			<h3 class="title">执行上下文</h3>
			<p>
				执行上下文的定义为：当每次控制器转到ECMAScript可执行的代码时，即会进入到一个执行上下文
				(这是一个抽象概念，我们可以理解为每次代码执行的时所依赖的参数、变量、函数的集合)
			</p>
			<p>平时我们所写的代码常见的我们可以分为两类，一类是函数代码，即我们平时定义的
			function method(){}的代码，函数代码里面所定义的变量称为局部变量，另一类是我们定义在
			函数外面的代码，我们称为全局代码，全局代码定义的变量称为全局变量</p>
			<p>全局变量只要定义我们可以在任何一个地方使用，而局部变量我们只能在定义他的函数内部使用。
			</p>
			<pre>
			var a = 1;
			function method(){
				var b = 2;
				alert(a);//弹出1
				alert(b);//弹出2
			}
			alert(a);//弹出1
			alert(b);//报错提示b未定义
			//a为全局变量可以在任何地方访问
			//b为局部便令只能在定义他的函数内访问
			</pre>
			<p>全局变量在定义之后就会一直存在，我们可以随时访问，直到我们关闭浏览器，全局变量才会结束
			他的生命周期。在函数内部定义的局部变量，在函数执行完成之后我们就不能再访问到里面的变量
			(闭包除外)，我们可以认为函数在执行完成之后里面的变量会被回收，当函数再次执行的时候
			变量在一次被创建。</p>
			<p>在代码定义完成之后会生成一条作用域链去保存我们定义的变量及函数，当我们调用函数的时候
			函数会首先在当前作用域去查找变量，如果当前作用域不存在该变量则去父级作用域去寻找，一直
			找到全局作用域，如果全局作用域仍然不存在，则代码报错提示变量未定义。</p>
		</div>
	</div>




		<div class="row">
			<div class="col-lg-12">
			<h3 class="title">闭包</h3>
			
			<p>首先，函数在声明时会产生一个静态作用域链去保存它的作用域内的变量，以便调用的时候
			可以访问到使用的变量。</p>

			<pre>
			var a = 10;
			function method(){
				alert(a);
			}
			function fn(){
				var a = 1;
				method();
			}
			fn();//弹出10
			//method函数在声明时生成了一个静态作用域链保存了a;当method执行的时候会通过静态作用域链
			去访问保存的a
			</pre>
			<pre>
			var a = 10
			function method(){
				var a = 1;
				function fn(){
					alert(a);
				}
				return fn;
			}
			var a = method();
			a();//弹出1
			//同样fn函数在声明的时候生成了一个静态作用域链保存了变量a,在fn执行的时候通过该静态作用域链
			去查找a。
			</pre>
			<p>如果多个函数的作用域是相同的，那么他们的静态作用域上的变量是共享的，一个函数改变了
			静态作用域上的变量，这个变量会影响到其他函数。</p>


			<p>这是我们经常看见的一个问题：</p>
			<pre>
			var handler = [];
			for(var i=0;i&lt5;i++){
				handler[i] = function(){
					alert(i);
				}
			}
			handler[0]();
			handler[1]();
			handler[2]();
			handler[3]();
			handler[4]();
			//每一个函数都是弹出5
			//声明的i是一个全局变量，而每一个函数在生成时都生成了一个静态作用域链去保存变量i,
			当最后一个函数完成声明时此时的i值已经变成了5，当我们调用函数时，函数通过静态作用域链
			去查找i所以最终每一个函数都会弹出5;
			</pre>
			<p>此时打破这个情况的方式如下：</p>
			<pre>
			var handler = [];
			for(var i=0;i&gt5;i++){
				handler[i] = (function(i){
					return function(){
						alert(i)
					}
				})(i)
			}
			//当循环开始是我们定义的自执行函数开始运行，同时把当次循环的i值作为实参传递
			到我们定义的自执行函数内，该自执行函数返回另一个函数，而返回的这个函数同样会生成一个静态
			作用域量去保存i而i的值指向我们传进去的参数。
			</pre>









		
			</div>
		</div>
	</div>
	<div class="navbar navbar-default clearMB">
		<div class="container">
			<h3>前端路上的小小鸟</h3>
			<h4>如有错误请指正，虚心求教。</h4>
			<h4>QQ:1370510025</h4>
		</div>
	</div>
 </body>
</html>
